<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>印刷ビューア - 出力統合メニュー</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f8f9fa;
    }

    header {
      background-color: #0077cc;
      color: white;
      padding: 1rem 2rem;
      font-size: 1.4rem;
      font-weight: bold;
      text-align: center;
    }

    #menu {
      display: flex;
      justify-content: center;
      gap: 1rem;
      padding: 1rem;
      background-color: #e9ecef;
    }

    #menu button {
      background-color: #2a9d8f;
      border: none;
      color: white;
      padding: 10px 20px;
      font-size: 1rem;
      border-radius: 6px;
      cursor: pointer;
    }

    #menu button:hover {
      background-color: #21867a;
    }

    #content {
      padding: 2rem;
      text-align: center;
    }

    .section-container {
      margin-top: 2rem;
      border-top: 1px solid #ccc;
      padding-top: 1rem;
    }

    #mindmapMetadata {
      text-align: left;
      margin-bottom: 1rem;
    }
  </style>
</head>
<body>
  <header>🖨️ 印刷・出力ビューア</header>

  <!-- ✅ 総合メニュー -->
  <div id="menu">
    <button onclick="loadSection('mindmap')">🧠 マインドマップ単体</button>
    <button onclick="loadSection('summary')">📊 統合出力（ダッシュボード）</button>
    <button onclick="loadSection('cards')">📇 実行策一覧</button>
    <button onclick="loadSection('3d')">🌐 3Dビューア</button>
  </div>

  <div id="content">
    <p>出力内容を選択してください。</p>
  </div>

  <!-- ✅ 統合出力などの追加UI領域 -->
  <div class="section-container" id="detailSections">
    <!-- 各セクション表示用：今後追加される詳細出力UIがここに展開されます -->
  </div>

  <script>
    const sessionKey = localStorage.getItem("selectedSessionKey");
    const sessionData = sessionKey ? JSON.parse(localStorage.getItem(sessionKey)) : null;

    function loadSection(type) {
      const content = document.getElementById("content");
      const details = document.getElementById("detailSections");
      content.innerHTML = "";
      details.innerHTML = "";

      if (type === "mindmap") {
        const region = sessionData?.region || localStorage.getItem("region") || "地域未設定";
        const theme = sessionData?.theme || localStorage.getItem("theme") || "テーマ未設定";
        const imageData = sessionData?.mindmapImageData || localStorage.getItem("mindmapImageData");
        const dateStr = new Date().toLocaleDateString();

        const metadata = document.createElement("div");
        metadata.id = "mindmapMetadata";
        metadata.innerHTML = `
          <p><strong>地域名：</strong>${region}</p>
          <p><strong>テーマ：</strong>${theme}</p>
          <p><strong>出力日：</strong>${dateStr}</p>
        `;

        const img = document.createElement("img");
        img.src = imageData;
        img.style.maxWidth = "100%";
        img.alt = "マインドマップ画像";

        content.appendChild(metadata);
        content.appendChild(img);

        details.innerHTML = "<p style='margin-top: 1rem;'>このマインドマップは、地域の課題と構造的な思考を可視化した資料です。</p>";
      } else if (type === "summary") {
        content.innerHTML = "<h2>📊 統合出力（ダッシュボード情報）</h2><p>※ここにダッシュボードの統合レポートが表示されます。</p>";
        details.innerHTML = "<p>[統合グラフ・KPI一覧・地域指標などのパネルが今後ここに展開されます]</p>";
      } else if (type === "cards") {
        content.innerHTML = "<h2>📇 実行策一覧出力</h2><p>※ここにカードの分類や一覧が表示されます。</p>";
        details.innerHTML = "<p>[Mind Trigger Card 表形式、ラベル分類、エクスポート機能予定]</p>";
      } else if (type === "3d") {
        window.open("3d_viewer.html", "_blank");
      }
    }
  </script>
</body>
</html>
